
<style type="text/css">
	

.apps-container {
	margin: 10px 10px 0 0;
	min-width:200px;
	min-height:50px;
	border: 1px solid #ccc;
	border-radius: 2px;
}

.apps-container-selected {
	margin: 10px 10px 0 0;
	min-height:50px;
}

.apps-container-selected-item{
	position: relative;
    padding-left: 40px;
    line-height: 40px;
    height: 40px;
}

/*.apps-container-selected-item:before{
	position: absolute;
	left: 0px;
	top:5px;
    content: '起';
    border: 4px solid #0086F9;
    width: 30px;
    height: 30px;
    border-radius: 100%;
    text-align: center;
    line-height: 23px;
}*/

.apps-container-selected-item:first-child:before{
	position: absolute;
	left: 0px;
	top:5px;
    content: '起';
    border: 4px solid #0086F9;
    width: 30px;
    height: 30px;
    border-radius: 100%;
    text-align: center;
    line-height: 23px;
}

.apps-container-selected-item:last-child:before{
	position: absolute;
	left: 0px;
	top:5px;
    content: '终';
    border: 4px solid #0086F9;
    width: 30px;
    height: 30px;
    border-radius: 100%;
    text-align: center;
    line-height: 23px;
}

.apps-container-selected-item:before{
    position: absolute;
    left: 5px;
    top: 11px;
    content: '';
    border: 4px solid #0086F9;
    width: 20px;
    height: 20px;
    border-radius: 100%;
    text-align: center;
    line-height: 23px;
    background: #fff;
    z-index: 3;
}

.apps-container-selected-item:after{
position: absolute;
    left: -12px;
    top: 11px;
    content: '';
    border-right: 4px solid #0086F9;
    width: 30px;
    height: 41px;
    text-align: center;
    line-height: 23px;
    z-index: 0;
}

.apps-container:nth-of-type(odd){
	border-right: 1px solid #f9f9f9;
}
.app {
	width: 100%;
	padding: 5px 10px;
	color: #666;
	font-size: 12px;
	font-weight: normal;
	text-align: left;
	cursor: move;
}
.app:nth-of-type(odd) {
	background-color: #f9f9f9;
}

.app:nth-of-type(odd) {
	background-color: #f9f9f9;
}

.floatleft {
  display: flex;
}
.route-box{
	margin-top: 20px;
}
.route-wrapper{
  flex: auto;
}
.route-title{
	height: 30px;
}
.route-line{
	border-right: 1px solid #ccc;
	margin-right: 10px;
	min-height: 380px;
}

.departureTime{
	position: absolute;
    top: 0px;
    right: 40px;
}
.departureTime input{
	height: 20px;
	width: 50px;
}

.route-list{
	position: relative;
	margin-top: 40px;
	min-height: 250px;
}

.route-list li{
	position: relative;
	width: 50px;
	display: inline-block;
}

.route-list li:before{
	position: absolute;
	content: '';
	top:0px;
	border:5px solid #338ca5;
	border-radius: 10px;
	height: 5px;
	width: 140%;
}

.route-list li:after{
	position: absolute;
	content: '';
	top:-3px;
	left: 30px;
	border:1px solid #338ca5;
	background: #fff;
	width: 15px;
	height: 15px;
	border-radius: 10px;
}

.siteTime{
	position: absolute;
    top: -25px;
    left: 22px;
    width: 50px;
}
.siteName{
	width: 10px;
    position: absolute;
    left: 34px;
    top: 20px;
    word-wrap: break-word;
    display: inline-block;
/*    transform: rotate(-30deg);*/
}

.viewSite{
	position: absolute;
    right: 24px;
    top: 10px;
}
</style>


<div class="title-wrapper breadcrumb-wrapper">
	<breadcrumb-component breadcrumb-params="breadcrumbParams" breadcrumb-text="breadcrumbText"></breadcrumb-component>
</div>

<div class="right-content-wrapper container-shadow-border">
	<div class="inner-content">
		<div class="info-wrapper">
			<form name="formValidateOne" novalidate>
				<div class="title">
					<h1>基础信息:</h1>
					<a ng-click="editRouteProfile(false)" ng-if="!active">编辑</a>
					<a ng-click="!submitOnProgress&& submitRouteUpdateBaseInfo(formValidateOne.$valid)" ng-if="active">完成</a> 
				</div>
				<div class="content">
					<div class="content-inline">
						<div class="content-inline-item"  ng-class="{'has-error':formValidateOne.routeName.$dirty && formValidateOne.routeName.$invalid,'has-success':formValidateOne.routeName.$dirty && !formValidateOne.routeName.$invalid}">
							<label for="routeName" class="control-label " >线路名称：</label>
							<input type="text"  
								   class= "form-control" 
								   name="routeName" 
								   id="routeName"
								   required=""
								   ng-disabled="!active" 
								   ng-class="{'edit':active,'preview':!active}" 
								   ng-model="params.routeName"
								   ng-maxlength="30"/><sup class="requireMark" ng-if="active">*</sup>
							<div class="error" ng-show="formValidateOne.routeName.$dirty && formValidateOne.routeName.$invalid" >
						        <small class="control-label" ng-show="formValidateOne.routeName.$error.required"> 请输入线路名称 </small>
						        <small class="control-label" ng-show="formValidateOne.routeName.$error.maxlength">线路名称过长，请重新输入</small>
						    </div>
						</div>

						<div class="content-inline-item" style="float: right;" ng-class="{'has-error':formValidateOne.phoneNumber.$dirty && formValidateOne.phoneNumber.$invalid,'has-success':formValidateOne.phoneNumber.$dirty && !formValidateOne.phoneNumber.$invalid}">
							<label class=" control-label " for="phoneNumber" >线路属性：</label>
							<span ng-if ='(params.routeType == "All") && !active'>上行/下行</span>
							<span ng-if ='(params.routeType == "AM") && !active'>仅上行</span>
							<span ng-if ='(params.routeType == "PM") && !active'>仅下行</span>
							<span ng-repeat="item in routeTypeList track by $index" ng-if="active">
								<input  type="radio" 
										id="item_{{$index}}"
										name = "checkbox"
										ng-checked ='params.routeType == item.routeType'
										ng-model='params.routeType'
										ng-click="selectRouteType(item.routeType)"/>
							    <label for="item_{{$index}}" class="check-box" style="width: 15px;display: inline-flex;"></label>
							   	<span  style="margin-top: -1px;font-size: 12px;margin-right: 5px;margin-left: 0px;"> {{item.name}}</span>
							</span>
						</div>	
					</div>
				</div>
			</form>	
		</div>
		
		<div ng-if='params.currentRouteType == params.routeType'>
			<div class="info-wrapper" ng-if = "!hideSiteIsActive">
				<div class="title"> <h1>线路站点设置:</h1> </div>
				<div class="route-box">
					<div class="route-line-wrapper" ng-show="(params.routeType == 'All') || params.routeType == 'AM'">
						<div class="route-title"> 上行线路：</div>
						<div class="route-list">
							<ul>
								<li ng-repeat = "station in params.stationTypeIsAMList track by $index"> 
									<span class="siteTime" ng-if='!$index'>起点</span>
									<span class="siteTime" ng-if = '$index'>{{station.departureTime +'min'}}</span><span class="siteName">{{station.stationName}}</span>
								</li>
							</ul>
							<a ng-click="goToSiteList('AM')" class="viewSite">查看站点</a>
						</div>
					</div>
					<div class="route-line-wrapper"  ng-show="(params.routeType == 'All') || params.routeType == 'PM'">
						<div class="route-title">下行线路：</div>
						<div class="route-list">
							<ul>
								<li ng-repeat = "station in params.stationTypeIsPMList track by $index"> 
									<span class="siteTime">{{!station.departureTime?'起点':station.departureTime+'min'}}</span><span class="siteName">{{station.stationName}}</span>
								</li>
							</ul>
							<a ng-click="goToSiteList('PM')" class="viewSite">查看站点</a>
						</div>
					</div>
				</div>
			</div>

			<div class="info-wrapper" ng-show="updateSiteIsActive">
				<div class="title"><h1>{{route.routeName}}:</h1></div>
				<div class="route-box">
					<form name="formValidate" novalidate> 
						<div class="floatleft">
							<div class="route-wrapper">
								<div class="route-line">
									<div class="route-title">
										<div class="input-group" style="width: 220px;">
											<label style="width:100px;">站点库</label>
								  			<input  type="text" class="form-control" style="height:24px;"  placeholder="搜索站点" ng-model="params.stationName">
										    <span class="input-group-btn">
										        <button class="btn btn-default" type="button" style="padding: 1px 6px;background: #338ca5;color: #fff;" ng-click="searchStationNameByRouteType(route.routeType)">
										 			搜索</button>
										    </span>
							   			</div>
									</div>
								    <div ui-sortable="sortableOptions" class="apps-container dragWrapper" ng-model="params.stationListFromSiteLibrary" style="overflow: auto; min-height: 400px;">
										<div class="app dragItem moveroverItem" ng-repeat="station in params.stationListFromSiteLibrary track by $index">
											{{station.stationName}}
											<a data-index='{{$index}}' class="stepTwoAddBtn" data-id="{{station.stationId}}" data-type="{{station.stationType}}"style="float: right; width: 60px;text-align: center;" ng-click="addSiteItemForRoute($event,$index,station.stationId,station.stationType)">加入线路</a>
										</div>
								    </div>
								</div>
							</div>

							<div class="route-wrapper">
								<div class="route-title">线路站点</div>
								<div ui-sortable="sortableOptions" class="apps-container-selected dragWrapper" ng-model="params.stationSelectedForRoute">
									<div class="apps-container-selected-item dragItem" 
										 ng-repeat="station in params.stationSelectedForRoute  track by $index" 
										 ng-class="{'has-error':formValidate.departureTime_{{$index}}.$dirty && formValidate.departureTime_{{$index}}.$invalid,'has-success':formValidate.departureTime_{{$index}}.$dirty && !formValidate.departureTime_{{$index}}.$invalid}">
											{{station.stationName}}
										<div class="departureTime" ng-if='$index!=0'>
											<input type="text" ng-model="station.departureTime" name="departureTime_{{$index}}" class= "form-control" required=""> 分钟</div>
											<a  style="float: right; width: 27px;text-align: center;" 
												ng-click="removeSiteItemFromSelectedList($event,$index,station.stationId,station.routeType,station.departureTime,station.routeStationId)">
													<img src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAUlJREFUKBV1kLtKxEAUhndCXiCFYGeVUrSy8QJBxRfQgIWFSBJUBAsRvKAGdEXtRMFsQoKdCAteFtfS1kYEX8DnUJP4HWHCuuiBmXP7/3/OHNVoNJ6VUree59Vr/1iSJMN5nieWZQ0YZVk2i6I4gLjzFz6KohHAj4g+ua77YQRBcAxwA2IYx/FuJ4l8lLzNuWKCJekpucRQWscdcUJE9hhjjJcfELr2fX+BF0rBVQRJGGsNwAnhJYBpfBPleeJC+mK/CFKAdAEpIHxDebATLH1DLm2MMQ54jvyF088fQt3TviKgPME27lFssb4h/CrkbUj7Giz+ZySKkzTvyFu2bc86jvMlTURWqJ8S1lnEltQUxSn8DacN2NVgaYohtsy2znjxkD9tCuGd+itKM6h8CqjbWPkihHPTNPtqWZb1Aq7+0g3WeZqmPRJ/A+4nlb/AMkzZAAAAAElFTkSuQmCC"/>
											</a>
										<div class="error" ng-show="formValidate.departureTime_{{$index}}.$dirty && formValidate.departureTime_{{$index}}.$invalid &&$index!=0" style="position: absolute;top: 20px;">
									        <small class="control-label" ng-show="formValidate.departureTime_{{$index}}.$error.required"> 请输入站点区间时间</small>
									    </div>
									</div>
						    	</div>
							</div>
						</div>

						<div class="content-inline" style="text-align: center;">
							<div class="btn-wrapper" style="margin-top: 40px;width: 100%;padding: 0;">
								<a ng-click="close()"  class="submitBtn submit-cancel">取消</a>
								<a ng-click="!submitOnProgress&& updateSiteForRouteConfirmBtn(formValidate.$valid,route.routeType)" class="submitBtn submit-ok">确定</a>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
		
		<div class="info-wrapper" ng-show="setOneRouteOnlyFlag">
			<div class="title"><h1>{{params.routeType == 'PM'?'下行线路站点：':'上行线路站点：'}}</h1></div>
			<div class="route-box">
				<form name="formValidateTwo" novalidate>
					<div class="floatleft">
						<div class="route-wrapper">
							<div class="route-line">
								<div class="route-title">
									<div class="input-group" style="width: 220px;">
										<label style="width:100px;">站点库</label>
							  			<input  type="text" class="form-control" style="height:24px;" placeholder="搜索站点" ng-model="params.stationName">
									    <span class="input-group-btn">
									        <button class="btn btn-default" type="button" style="padding: 1px 6px;background: #338ca5;color: #fff;" ng-click="searchStationNameByRouteTypeForAMOrPM()">
									 			搜索</button>
									    </span>
						   			</div>
								</div>
							    <div ui-sortable="sortableOptions" class="apps-container dragWrapper" ng-model="params.stationList" style="overflow: auto; min-height: 400px;">
									<div class="app dragItem moveroverItem" ng-repeat="station in params.stationListBySearchForAMOrPM track by $index">
										{{station.stationName}}
										<a  style="float: right; width: 60px;text-align: center;" ng-click="addSiteItemForAMOrPMOnly($event,$index,station.stationId,station.stationType)">加入线路</a>
									</div>
							    </div>
							</div>
						</div>



						<div class="route-wrapper">
							<div>
								<div class="route-title">线路站点</div>
									<div ui-sortable="sortableOptions" class="apps-container-selected dragWrapper" ng-model="params.stationListBySearchForAMOrPM_1">
										<div 	class="apps-container-selected-item dragItem"
												ng-repeat="station in params.stationListBySearchForAMOrPM_1 track by $index " 
												id="item_{{$index}}"
												ng-class="{'has-error':formValidateTwo.departureTime_{{$index}}.$dirty && formValidateTwo.departureTime_{{$index}}.$invalid,'has-success':formValidateTwo.departureTime_{{$index}}.$dirty && !formValidateTwo.departureTime_{{$index}}.$invalid}">
												{{station.stationName}}
											<div class="departureTime" ng-if='$index!=0'>
												<input  name="departureTime_{{$index}}" 
														type="text" 
														class= "form-control"
														ng-model="station.departureTime" 
														id="stepTwoDepartureTime_{{$index}}"
														required=""> 分钟</div>
												<a 	style="float: right; width: 27px;text-align: center;" 
													ng-click="removeSiteItemForAMOrPMOnly($event,$index,station.stationId,station.stationType)">
														<img src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAUlJREFUKBV1kLtKxEAUhndCXiCFYGeVUrSy8QJBxRfQgIWFSBJUBAsRvKAGdEXtRMFsQoKdCAteFtfS1kYEX8DnUJP4HWHCuuiBmXP7/3/OHNVoNJ6VUree59Vr/1iSJMN5nieWZQ0YZVk2i6I4gLjzFz6KohHAj4g+ua77YQRBcAxwA2IYx/FuJ4l8lLzNuWKCJekpucRQWscdcUJE9hhjjJcfELr2fX+BF0rBVQRJGGsNwAnhJYBpfBPleeJC+mK/CFKAdAEpIHxDebATLH1DLm2MMQ54jvyF088fQt3TviKgPME27lFssb4h/CrkbUj7Giz+ZySKkzTvyFu2bc86jvMlTURWqJ8S1lnEltQUxSn8DacN2NVgaYohtsy2znjxkD9tCuGd+itKM6h8CqjbWPkihHPTNPtqWZb1Aq7+0g3WeZqmPRJ/A+4nlb/AMkzZAAAAAElFTkSuQmCC"/></a>
												<div class="error"  
													 ng-show="formValidateTwo.departureTime_{{$index}}.$dirty && formValidateTwo.departureTime_{{$index}}.$invalid &&$index!=0"
													 style="position: absolute;top: 20px;">
											        <small class="control-label" 
											            ng-show="formValidateTwo.departureTime_{{$index}}.$error.required">
											            请输入站点区间时间
											        </small>
											    </div>
											</div>
						    			</div>
									</div>
						</div>
					</div>

					<div class="content-inline" style="text-align: center;">
						<div class="btn-wrapper" style="margin-top: 40px;width: 100%;padding: 0;">
							<a ng-click="pre()"  class="submitBtn submit-cancel">上一步</a>
							<a ng-click="!submitOnProgress&& updateRouteByNewRouteTypeForAMOrPMOlny(formValidateTwo.$valid)" class="submitBtn submit-ok">{{params.routeType == 'All'? '下一步':'确定'}}</a>
						</div>
					</div>
				</form>
			</div>
		</div>


		<div class="info-wrapper" ng-show="setRouteTypeForAll">
			<div class="title"><h1>下行线路站点:</h1></div>
			<div class="route-box">
				<form name="formValidateThree" novalidate>
					<div class="floatleft">
						<div class="route-wrapper">
							<div class="route-line">
								<div class="route-title">
									<div class="input-group" style="width: 220px;">
										<label style="width:100px;">站点库</label>
							  			<input  type="text" class="form-control" style="height:24px;" placeholder="搜索站点" ng-model="params.stationName">
									    <span class="input-group-btn">
									        <button class="btn btn-default" type="button" style="padding: 1px 6px;background: #338ca5;color: #fff;" ng-click="searchStationNameByRouteTypeForAMOrPM()">搜索</button>
									    </span>
						   			</div>
								</div>
							    <div ui-sortable="sortableOptions_2" class="apps-container dragWrapper_2" ng-model="params.stationListBySearchForPM" style="overflow: auto;  min-height: 400px;">
									<div class="app dragItem_2 moveroverItem" id="addItemForStepThree_{{$index}}" ng-repeat="station in params.stationListBySearchForPM track by $index">
										{{station.stationName}}
										<a class="stepTwoAddBtn" style="float: right; width: 60px;text-align: center;" ng-click="addSiteItemForPM($event,$index,station.stationId,station.stationType)">加入线路</a>
									</div>
							    </div>
							</div>
						</div>

						<div class="route-wrapper">
							<div>
								<div class="route-title">线路站点</div>
								<div ui-sortable="sortableOptions_2" class="apps-container-selected dragWrapper_2" ng-model="params.stationListForPM">
									<div class="apps-container-selected-item dragItem_2"  ng-repeat="station in params.stationListForPM track by $index" id="item_{{$index}}" ng-class="{'has-error':formValidateThree.departureTime_{{$index}}.$dirty && formValidateThree.departureTime_{{$index}}.$invalid,'has-success':formValidateThree.departureTime_{{$index}}.$dirty && !formValidateThree.departureTime_{{$index}}.$invalid}">
											{{station.stationName}}
										<div class="departureTime" ng-if='$index!=0'>
											<input type="text" ng-model="station.departureTime" name="departureTime_{{$index}}" class= "form-control" required=""> 分钟</div>
											<a  style="float: right; width: 27px;text-align: center;" ng-click="removeSiteItemForStepThree($event,$index,station.stationId,station.stationType)">
													<img src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAUlJREFUKBV1kLtKxEAUhndCXiCFYGeVUrSy8QJBxRfQgIWFSBJUBAsRvKAGdEXtRMFsQoKdCAteFtfS1kYEX8DnUJP4HWHCuuiBmXP7/3/OHNVoNJ6VUree59Vr/1iSJMN5nieWZQ0YZVk2i6I4gLjzFz6KohHAj4g+ua77YQRBcAxwA2IYx/FuJ4l8lLzNuWKCJekpucRQWscdcUJE9hhjjJcfELr2fX+BF0rBVQRJGGsNwAnhJYBpfBPleeJC+mK/CFKAdAEpIHxDebATLH1DLm2MMQ54jvyF088fQt3TviKgPME27lFssb4h/CrkbUj7Giz+ZySKkzTvyFu2bc86jvMlTURWqJ8S1lnEltQUxSn8DacN2NVgaYohtsy2znjxkD9tCuGd+itKM6h8CqjbWPkihHPTNPtqWZb1Aq7+0g3WeZqmPRJ/A+4nlb/AMkzZAAAAAElFTkSuQmCC"/>
											</a>
										<div class="error" ng-show="formValidateThree.departureTime_{{$index}}.$dirty && formValidateThree.departureTime_{{$index}}.$invalid &&$index!=0" style="position: absolute;top: 20px;">
									        <small class="control-label" ng-show="formValidateThree.departureTime_{{$index}}.$error.required"> 请输入站点区间时间</small>
									    </div>
									</div>
						    	</div>
							</div>
						</div>
					</div>

					<div class="content-inline" style="text-align: center;">
						<div class="btn-wrapper" style="margin-top: 40px;width: 100%;padding: 0;">
							<a ng-click="stepThreePre()"  class="submitBtn submit-cancel">上一步</a>
							<a ng-click="!submitOnProgress&& updateRouteForAllRouteType(formValidateThree.$valid)" class="submitBtn submit-ok">确定</a>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>